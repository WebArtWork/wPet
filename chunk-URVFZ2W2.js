import{a as k,b as D}from"./chunk-N6KVFGXY.js";import{e as j}from"./chunk-7MKG6VHM.js";import{K as s,L as p,M as _,Qa as v,R as f,Sa as w,Wa as g,X as u,bb as y,f as a,hb as C,i as n,ob as S,s as m,vb as b,xb as M}from"./chunk-3B44IZU7.js";var h=(()=>{class r{constructor(t,i,e,c,l,R,I){this._translate=t,this._petdoctorService=i,this._alert=e,this._form=c,this._core=l,this._router=R,this._route=I,this.columns=["name","specialization","phone","email","workingHours","description"],this.form=this._form.getForm("petdoctor",k),this.config={paginate:this.setRows.bind(this),perPage:20,setPerPage:this._petdoctorService.setPerPage.bind(this._petdoctorService),allDocs:!1,create:this._router.url.includes("doctors/")?()=>{this._form.modal(this.form,{label:"Create",click:(o,d)=>a(this,null,function*(){d(),this._preCreate(o),yield n(this._petdoctorService.create(o)),this.setRows()})})}:null,update:o=>{this._form.modal(this.form,[],o).then(d=>{this._core.copy(d,o),this._petdoctorService.update(o)})},delete:o=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this petdoctor?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>a(this,null,function*(){yield n(this._petdoctorService.delete(o)),this.setRows()})}]})},buttons:[{icon:"cloud_download",click:o=>{this._form.modalUnique("petdoctor","url",o)}}],headerButtons:[{icon:"playlist_add",click:this._bulkManagement(),class:"playlist"},{icon:"edit_note",click:this._bulkManagement(!1),class:"edit"}]},this.rows=[],this.clinic_id="",this._page=1,this.setRows(),this._route.paramMap.subscribe(o=>{this.clinic_id=o.get("clinic_id")||""})}setRows(t=this._page){this._page=t,this._core.afterWhile(this,()=>{this._petdoctorService.get({page:t,query:this._query()}).subscribe(i=>{this.rows.splice(0,this.rows.length),this.rows.push(...i)})},250)}_bulkManagement(t=!0){return()=>{this._form.modalDocs(t?[]:this.rows).then(i=>a(this,null,function*(){if(t)for(let e of i)this._preCreate(e),yield n(this._petdoctorService.create(e));else{for(let e of this.rows)i.find(c=>c._id===e._id)||(yield n(this._petdoctorService.delete(e)));for(let e of i){let c=this.rows.find(l=>l._id===e._id);c?(this._core.copy(e,c),yield n(this._petdoctorService.update(c))):(this._preCreate(e),yield n(this._petdoctorService.create(e)))}}this.setRows()}))}}_preCreate(t){delete t.__created,this.clinic_id&&(t.clinic=this.clinic_id)}_query(){let t="";return this.clinic_id&&(t+=(t?"&":"")+"clinic="+this.clinic_id),t}static{this.\u0275fac=function(i){return new(i||r)(s(S),s(D),s(C),s(M),s(y),s(w),s(v))}}static{this.\u0275cmp=p({type:r,selectors:[["ng-component"]],standalone:!1,decls:1,vars:3,consts:[["title","Doctors",3,"columns","config","rows"]],template:function(i,e){i&1&&u(0,"wtable",0),i&2&&f("columns",e.columns)("config",e.config)("rows",e.rows)},dependencies:[b],encapsulation:2})}}return r})();var q=[{path:"",component:h},{path:":clinic_id",component:h}],G=(()=>{class r{static{this.\u0275fac=function(i){return new(i||r)}}static{this.\u0275mod=_({type:r})}static{this.\u0275inj=m({imports:[g.forChild(q),j]})}}return r})();export{G as DoctorsModule};
