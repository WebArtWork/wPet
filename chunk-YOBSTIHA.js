import{a as F}from"./chunk-XWTNKRNA.js";import{a as M}from"./chunk-Y3STHWDL.js";import{e as P}from"./chunk-7MKG6VHM.js";import{K as a,L as d,M as _,Qa as v,R as f,Wa as w,X as u,bb as g,f as n,hb as y,i as c,ob as C,s as m,vb as S,xb as b}from"./chunk-3B44IZU7.js";var l=(()=>{class o{constructor(e,s,i,r,p,j){this._translate=e,this._petplaceService=s,this._alert=i,this._form=r,this._core=p,this._route=j,this.columns=["name","address","latitude","longitude","placeType","description"],this.form=this._form.getForm("petplace",F),this.config={paginate:this.setRows.bind(this),perPage:20,setPerPage:this._petplaceService.setPerPage.bind(this._petplaceService),allDocs:!1,create:()=>{this._form.modal(this.form,{label:"Create",click:(t,h)=>n(this,null,function*(){h(),this._preCreate(t),yield c(this._petplaceService.create(t)),this.setRows()})})},update:t=>{this._form.modal(this.form,[],t).then(h=>{this._core.copy(h,t),this._petplaceService.update(t)})},delete:t=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this petplace?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>n(this,null,function*(){yield c(this._petplaceService.delete(t)),this.setRows()})}]})},buttons:[{icon:"medication",hrefFunc:t=>"/drugs/"+t._id},{icon:"restaurant_menu",hrefFunc:t=>"/food/"+t._id},{icon:"category",hrefFunc:t=>"/items/"+t._id},{icon:"cloud_download",click:t=>{this._form.modalUnique("petplace","url",t)}}],headerButtons:[{icon:"playlist_add",click:this._bulkManagement(),class:"playlist"},{icon:"edit_note",click:this._bulkManagement(!1),class:"edit"}]},this.rows=[],this.clinic_id="",this.store_id="",this._page=1,this.setRows(),this._route.paramMap.subscribe(t=>{this.clinic_id=t.get("clinic_id")||"",this.store_id=t.get("store_id")||""})}setRows(e=this._page){this._page=e,this._core.afterWhile(this,()=>{this._petplaceService.get({page:e,query:this._query()}).subscribe(s=>{this.rows.splice(0,this.rows.length),this.rows.push(...s)})},250)}_bulkManagement(e=!0){return()=>{this._form.modalDocs(e?[]:this.rows).then(s=>n(this,null,function*(){if(e)for(let i of s)this._preCreate(i),yield c(this._petplaceService.create(i));else{for(let i of this.rows)s.find(r=>r._id===i._id)||(yield c(this._petplaceService.delete(i)));for(let i of s){let r=this.rows.find(p=>p._id===i._id);r?(this._core.copy(i,r),yield c(this._petplaceService.update(r))):(this._preCreate(i),yield c(this._petplaceService.create(i)))}}this.setRows()}))}}_preCreate(e){delete e.__created,this.clinic_id&&(e.clinic=this.clinic_id),this.store_id&&(e.store=this.store_id)}_query(){let e="";return this.clinic_id&&(e+=(e?"&":"")+"clinic="+this.clinic_id),this.store_id&&(e+=(e?"&":"")+"store="+this.store_id),e}static{this.\u0275fac=function(s){return new(s||o)(a(C),a(M),a(y),a(b),a(g),a(v))}}static{this.\u0275cmp=d({type:o,selectors:[["ng-component"]],standalone:!1,decls:1,vars:3,consts:[["title","Places",3,"columns","config","rows"]],template:function(s,i){s&1&&u(0,"wtable",0),s&2&&f("columns",i.columns)("config",i.config)("rows",i.rows)},dependencies:[S],encapsulation:2})}}return o})();var R=[{path:"",component:l},{path:"clinic/:clinic_id",component:l},{path:"store/:store_id",component:l}],E=(()=>{class o{static{this.\u0275fac=function(s){return new(s||o)}}static{this.\u0275mod=_({type:o})}static{this.\u0275inj=m({imports:[w.forChild(R),P]})}}return o})();export{E as PlacesModule};
